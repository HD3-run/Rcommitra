import{r as n,j as e}from"./index-Cmzhr2PI.js";import{f as g}from"./currency-DGtur7pf.js";import{D as R,u as m,w as _,E as $,a as A}from"./jspdf.plugin.autotable-D5Z2eyjb.js";import{aa as E,ab as T,ac as L,ad as F,ae as y,af as I,ag as O,ah as b}from"./LineChart-Hj8hp8Mf.js";function Y(){const[s,f]=n.useState("daily"),[x,j]=n.useState(""),[h,v]=n.useState(""),[r,p]=n.useState([]),[c,u]=n.useState(!0),w=async()=>{try{u(!0);const t=await fetch(`/api/reports?type=${s}&startDate=${x}&endDate=${h}`,{credentials:"include"});if(t.ok){const a=await t.json();p(a.data||[])}else console.error("Failed to fetch reports data"),p([])}catch(t){console.error("Error fetching reports:",t),p([])}finally{u(!1)}};n.useEffect(()=>{w()},[s,x,h]);const k=()=>{const t=["Date","Sales Count","Revenue"],a=r.map(i=>[i.date,i.sales,i.revenue]),d=[t,...a].map(i=>i.map(C=>`"${C}"`).join(",")).join(`
`),l=new Blob([d],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),N=URL.createObjectURL(l);o.setAttribute("href",N),o.setAttribute("download",`sales_report_${s}_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},S=()=>{const t=["Date","Sales Count","Revenue"],a=r.map(o=>[o.date,o.sales,o.revenue]),d=m.aoa_to_sheet([t,...a]),l=m.book_new();m.book_append_sheet(l,d,"Sales Report"),_(l,`sales_report_${s}_${new Date().toISOString().split("T")[0]}.xlsx`)},D=()=>{const t=new $;t.setFontSize(16),t.text(`Sales Report - ${s.charAt(0).toUpperCase()+s.slice(1)}`,14,15),t.setFontSize(10),t.text(`Generated on: ${new Date().toLocaleDateString()}`,14,25);const a=[["Date","Sales Count","Revenue"]],d=r.map(l=>[l.date,l.sales.toString(),g(l.revenue)]);A(t,{head:a,body:d,startY:35,styles:{fontSize:10},headStyles:{fillColor:[66,139,202]}}),t.save(`sales_report_${s}_${new Date().toISOString().split("T")[0]}.pdf`)};return e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 bg-light-pink dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Sales Reports"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsxs("select",{value:s,onChange:t=>f(t.target.value),className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"daily",children:"Daily Sales"}),e.jsx("option",{value:"monthly",children:"Monthly Sales"}),e.jsx("option",{value:"yearly",children:"Yearly Sales"})]}),e.jsx(R,{onDownloadCSV:k,onDownloadExcel:S,onDownloadPDF:D})]}),(s==="daily"||s==="monthly")&&e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 w-full sm:w-2/3 justify-end",children:[e.jsx("input",{type:s==="daily"?"date":"month",value:x,onChange:t=>j(t.target.value),className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),e.jsx("input",{type:s==="daily"?"date":"month",value:h,onChange:t=>v(t.target.value),className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"bg-light-pink-100 dark:bg-gray-800 p-6 rounded-lg shadow mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Sales and Revenue Overview"}),c?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-lg",children:"Loading reports..."})}):r.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-lg text-gray-500",children:"No data available for the selected period"})}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(T,{data:r,children:[e.jsx(L,{strokeDasharray:"3 3",stroke:"#4a4a4a"}),e.jsx(F,{dataKey:"date",stroke:"#9ca3af"}),e.jsx(y,{yAxisId:"left",stroke:"#9ca3af"}),e.jsx(y,{yAxisId:"right",orientation:"right",stroke:"#9ca3af"}),e.jsx(I,{formatter:(t,a)=>a==="Revenue"?[g(t),a]:[t,a]}),e.jsx(O,{}),e.jsx(b,{yAxisId:"left",type:"monotone",dataKey:"sales",stroke:"#8884d8",name:"Sales"}),e.jsx(b,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#82ca9d",name:"Revenue"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-light-pink-100 dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Total Sales"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:c?"...":r.reduce((t,a)=>t+a.sales,0)})]}),e.jsxs("div",{className:"bg-light-pink-100 dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Total Revenue"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:c?"...":g(r.reduce((t,a)=>t+a.revenue,0))})]}),e.jsxs("div",{className:"bg-light-pink-100 dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Average Sales per Period"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:c?"...":r.length>0?(r.reduce((t,a)=>t+a.sales,0)/r.length).toFixed(2):"0"})]})]})]})}export{Y as default};
