import{r as s,j as e}from"./index-Cmzhr2PI.js";import{f as N}from"./currency-DGtur7pf.js";function C(){const[l,o]=s.useState([]),[m,p]=s.useState(!0),[x,n]=s.useState(null),[d,h]=s.useState(""),[i,u]=s.useState("all"),[b,f]=s.useState([]);s.useEffect(()=>{g()},[]);const g=async()=>{try{n(null),console.log("Loading inventory for employee inventory page");const t=await fetch("/api/inventory",{credentials:"include"});if(console.log("Employee inventory API response:",{status:t.status,ok:t.ok,headers:Object.fromEntries(t.headers.entries())}),!t.ok){const a=await t.text();console.error("API Error in EmployeeInventory:",t.status,a),n(`Failed to load inventory: ${t.status} - ${a}`),o([]);return}const r=await t.json();if(console.log("Employee inventory data:",r),r.products&&Array.isArray(r.products)){const a=r.products;o(a),console.log("Loaded products for employee:",r.products.length);const v=Array.from(new Set(a.map(c=>c.category).filter(c=>!!c)));f(v)}else console.warn("No products array in employee inventory response:",r),o([]),r.debug&&console.log("Debug info from employee inventory API:",r.debug)}catch(t){console.error("Failed to load employee inventory:",t),n(t instanceof Error?t.message:"Failed to load inventory"),o([])}finally{p(!1)}},y=l.filter(t=>{const r=t.product_name.toLowerCase().includes(d.toLowerCase())||t.sku.toLowerCase().includes(d.toLowerCase()),a=i==="all"||t.category===i;return r&&a}),w=l.length,j=l.filter(t=>t.quantity_available<=t.reorder_level).length,k=l.filter(t=>t.quantity_available===0).length;return m?e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Inventory"}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading inventory..."})]})})]}):e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Inventory"}),x&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"font-bold",children:"Error Loading Inventory:"}),e.jsx("span",{className:"block sm:inline ml-2",children:x})]}),e.jsx("button",{onClick:()=>{n(null),g()},className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Total Products"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:w})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Low Stock"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:j})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Out of Stock"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:k})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Search by product name or SKU...",className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md w-full sm:w-auto bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:d,onChange:t=>h(t.target.value)}),e.jsxs("select",{className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:i,onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),b.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Reorder Level"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unit Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No products found."})}):y.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:t.product_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.sku}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.category||"Uncategorized"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.quantity_available}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.reorder_level}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:N(t.unit_price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.quantity_available===0?"bg-red-100 text-red-800":t.quantity_available<=t.reorder_level?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:t.quantity_available===0?"Out of Stock":t.quantity_available<=t.reorder_level?"Low Stock":"In Stock"})})]},t.product_id))})]})})]})}export{C as default};
